<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>70/30 Earnings</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
  <h1>üîê 70/30 Earnings</h1>
  <input type="email" id="email" placeholder="Email" required><br>
  <input type="password" id="password" placeholder="Password" required><br>
  <button onclick="login()">Login</button>
  <button onclick="createAccount()">Create Account</button><br>
  <button onclick="forgotPassword()">Forgot Password</button>
  <div id="message" style="margin-top: 10px; color: black;"></div>

  <div id="logout-container" style="position: fixed; top: 10px; right: 10px; z-index: 100;">
    <button onclick="logout()" style="padding: 10px 20px; font-size: 16px;">Logout</button>
  </div>

  <script>
    const backendURL = "https://seven030app-backend.onrender.com";

    async function login() {
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;
      const res = await fetch(`${backendURL}/login`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password })
      });

      const data = await res.json();
      document.getElementById("message").textContent = data.message || "Login complete.";

      if (res.ok) {
        localStorage.setItem("user", email);
        location.reload();
      }
    }

    async function createAccount() {
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;
      const res = await fetch(`${backendURL}/create`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password })
      });

      const data = await res.json();
      document.getElementById("message").textContent = data.message || "Account created.";

      if (res.ok) {
        localStorage.setItem("user", email);
        location.reload();
      }
    }

    async function forgotPassword() {
      const email = document.getElementById("email").value.trim();
      const res = await fetch(`${backendURL}/forgot`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email })
      });

      const data = await res.json();
      document.getElementById("message").textContent = data.message || "Password reset email sent.";
    }

    function logout() {
      localStorage.removeItem("user");
      location.reload();
    }

    // Auto-fill email if remembered
    const savedEmail = localStorage.getItem("user");
    if (savedEmail) {
      document.getElementById("email").value = savedEmail;
    }
  </script>
</body>
</html>
